load vss;

CREATE TABLE embedding (vec FLOAT[512], name varchar); 

INSERT INTO embedding
  SELECT array_value("1dim", "2dim", "3dim", "4dim", "5dim", "6dim", "7dim", "8dim", "9dim", "10dim", "11dim", "12dim", "13dim", "14dim", "15dim", "16dim", "17dim", "18dim", "19dim", "20dim", "21dim", "22dim", "23dim", "24dim", "25dim", "26dim", "27dim", "28dim", "29dim", "30dim", "31dim", "32dim", "33dim", "34dim", "35dim", "36dim", "37dim", "38dim", "39dim", "40dim", "41dim", "42dim", "43dim", "44dim", "45dim", "46dim", "47dim", "48dim", "49dim", "50dim", "51dim", "52dim", "53dim", "54dim", "55dim", "56dim", "57dim", "58dim", "59dim", "60dim", "61dim", "62dim", "63dim", "64dim", "65dim", "66dim", "67dim", "68dim", "69dim", "70dim", "71dim", "72dim", "73dim", "74dim", "75dim", "76dim", "77dim", "78dim", "79dim", "80dim", "81dim", "82dim", "83dim", "84dim", "85dim", "86dim", "87dim", "88dim", "89dim", "90dim", "91dim", "92dim", "93dim", "94dim", "95dim", "96dim", "97dim", "98dim", "99dim", "100dim", "101dim", "102dim", "103dim", "104dim", "105dim", "106dim", "107dim", "108dim", "109dim", "110dim", "111dim", "112dim", "113dim", "114dim", "115dim", "116dim", "117dim", "118dim", "119dim", "120dim", "121dim", "122dim", "123dim", "124dim", "125dim", "126dim", "127dim", "128dim", "129dim", "130dim", "131dim", "132dim", "133dim", "134dim", "135dim", "136dim", "137dim", "138dim", "139dim", "140dim", "141dim", "142dim", "143dim", "144dim", "145dim", "146dim", "147dim", "148dim", "149dim", "150dim", "151dim", "152dim", "153dim", "154dim", "155dim", "156dim", "157dim", "158dim", "159dim", "160dim", "161dim", "162dim", "163dim", "164dim", "165dim", "166dim", "167dim", "168dim", "169dim", "170dim", "171dim", "172dim", "173dim", "174dim", "175dim", "176dim", "177dim", "178dim", "179dim", "180dim", "181dim", "182dim", "183dim", "184dim", "185dim", "186dim", "187dim", "188dim", "189dim", "190dim", "191dim", "192dim", "193dim", "194dim", "195dim", "196dim", "197dim", "198dim", "199dim", "200dim", "201dim", "202dim", "203dim", "204dim", "205dim", "206dim", "207dim", "208dim", "209dim", "210dim", "211dim", "212dim", "213dim", "214dim", "215dim", "216dim", "217dim", "218dim", "219dim", "220dim", "221dim", "222dim", "223dim", "224dim", "225dim", "226dim", "227dim", "228dim", "229dim", "230dim", "231dim", "232dim", "233dim", "234dim", "235dim", "236dim", "237dim", "238dim", "239dim", "240dim", "241dim", "242dim", "243dim", "244dim", "245dim", "246dim", "247dim", "248dim", "249dim", "250dim", "251dim", "252dim", "253dim", "254dim", "255dim", "256dim", "257dim", "258dim", "259dim", "260dim", "261dim", "262dim", "263dim", "264dim", "265dim", "266dim", "267dim", "268dim", "269dim", "270dim", "271dim", "272dim", "273dim", "274dim", "275dim", "276dim", "277dim", "278dim", "279dim", "280dim", "281dim", "282dim", "283dim", "284dim", "285dim", "286dim", "287dim", "288dim", "289dim", "290dim", "291dim", "292dim", "293dim", "294dim", "295dim", "296dim", "297dim", "298dim", "299dim", "300dim", "301dim", "302dim", "303dim", "304dim", "305dim", "306dim", "307dim", "308dim", "309dim", "310dim", "311dim", "312dim", "313dim", "314dim", "315dim", "316dim", "317dim", "318dim", "319dim", "320dim", "321dim", "322dim", "323dim", "324dim", "325dim", "326dim", "327dim", "328dim", "329dim", "330dim", "331dim", "332dim", "333dim", "334dim", "335dim", "336dim", "337dim", "338dim", "339dim", "340dim", "341dim", "342dim", "343dim", "344dim", "345dim", "346dim", "347dim", "348dim", "349dim", "350dim", "351dim", "352dim", "353dim", "354dim", "355dim", "356dim", "357dim", "358dim", "359dim", "360dim", "361dim", "362dim", "363dim", "364dim", "365dim", "366dim", "367dim", "368dim", "369dim", "370dim", "371dim", "372dim", "373dim", "374dim", "375dim", "376dim", "377dim", "378dim", "379dim", "380dim", "381dim", "382dim", "383dim", "384dim", "385dim", "386dim", "387dim", "388dim", "389dim", "390dim", "391dim", "392dim", "393dim", "394dim", "395dim", "396dim", "397dim", "398dim", "399dim", "400dim", "401dim", "402dim", "403dim", "404dim", "405dim", "406dim", "407dim", "408dim", "409dim", "410dim", "411dim", "412dim", "413dim", "414dim", "415dim", "416dim", "417dim", "418dim", "419dim", "420dim", "421dim", "422dim", "423dim", "424dim", "425dim", "426dim", "427dim", "428dim", "429dim", "430dim", "431dim", "432dim", "433dim", "434dim", "435dim", "436dim", "437dim", "438dim", "439dim", "440dim", "441dim", "442dim", "443dim", "444dim", "445dim", "446dim", "447dim", "448dim", "449dim", "450dim", "451dim", "452dim", "453dim", "454dim", "455dim", "456dim", "457dim", "458dim", "459dim", "460dim", "461dim", "462dim", "463dim", "464dim", "465dim", "466dim", "467dim", "468dim", "469dim", "470dim", "471dim", "472dim", "473dim", "474dim", "475dim", "476dim", "477dim", "478dim", "479dim", "480dim", "481dim", "482dim", "483dim", "484dim", "485dim", "486dim", "487dim", "488dim", "489dim", "490dim", "491dim", "492dim", "493dim", "494dim", "495dim", "496dim", "497dim", "498dim", "499dim", "500dim", "501dim", "502dim", "503dim", "504dim", "505dim", "506dim", "507dim", "508dim", "509dim", "510dim", "511dim", "512dim") AS vec, name FROM "./df.parquet";

CREATE INDEX hnsw_index ON embedding USING HNSW (vec) WITH (metric = 'cosine');
